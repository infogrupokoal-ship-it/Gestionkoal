{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
    <h1>{{ title }}</h1>
    <div class="formulario">
        <form method="post">
            <label for="username">Usuario</label>
            <input type="text" id="username" name="username" value="{{ user.username or '' }}" required>

            <label for="email">Email</label>
            <input type="email" id="email" name="email" value="{{ user.email or '' }}">

            <label for="password">Contrase√±a {% if user.id %}(dejar en blanco para no cambiar){% endif %}</label>
            <input type="password" id="password" name="password" {% if not user.id %}required{% endif %}>

            <label for="role">Rol</label>
            <select id="role" name="role" required>
                <option value="">-- Seleccionar Rol --</option>
                {% for role in roles %}
                    <option value="{{ role.code }}" {% if role.code == user_current_role_code %}selected{% endif %}>
                        {{ role.descripcion or role.code }}
                    </option>
                {% endfor %}
            </select>

            <button type="submit">Guardar</button>
            <button type="button" id="fill-example-btn">Rellenar Ejemplo</button>
        </form>
    </div>
{% endblock %}

{% block scripts %}
<script>
    document.getElementById('fill-example-btn').addEventListener('click', function() {
        document.getElementById('username').value = 'ejem.tecnico';
        document.getElementById('email').value = 'tecnico@ejemplo.com';
        document.getElementById('password').value = 'password123';
        
        // Set the role dropdown to a default value, e.g., 'tecnico'
        const roleSelect = document.getElementById('role');
        if (roleSelect) {
            const tecnicoOption = roleSelect.querySelector('option[value="tecnico"]');
            if (tecnicoOption) {
                roleSelect.value = 'tecnico';
            } else if (roleSelect.options.length > 1) {
                // As a fallback, select the second option (the first real role)
                roleSelect.selectedIndex = 1;
            }
        }
    });
</script>
{% endblock %}